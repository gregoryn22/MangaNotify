  :root{
    --bg: #0b1020;
    --bg-soft: rgba(255,255,255,.06);
    --card: rgba(255,255,255,.08);
    --border: rgba(255,255,255,.12);
    --text: #e7e9f3;
    --muted: #9aa3b2;
    --accent: #7c9cff;
    --accent-strong: #4e75ff;
    --shadow: 0 10px 30px rgba(0,0,0,.35);
    --radius: 14px;
    --focus: 2px solid color-mix(in oklab, var(--accent) 65%, #fff);
  }
  @media (prefers-color-scheme: light){
    :root{
      --bg:#f7f8fb; --bg-soft:#ffffffcf; --card:#ffffffd6; --border:#e6e8ee;
      --text:#111827; --muted:#5b6472; --accent:#375dfb; --accent-strong:#2147f0;
      --shadow: 0 10px 28px rgba(17,23,39,.08);
    }
  }
  [data-theme="light"]{
    --bg:#f7f8fb; --bg-soft:#ffffffcf; --card:#ffffffd6; --border:#e6e8ee;
    --text:#111827; --muted:#5b6472; --accent:#375dfb; --accent-strong:#2147f0;
    --shadow: 0 10px 28px rgba(17,23,39,.08);
  }
  [data-theme="dark"]{
    --bg: #0b1020; --bg-soft: rgba(255,255,255,.06); --card: rgba(255,255,255,.08);
    --border: rgba(255,255,255,.12); --text:#e7e9f3; --muted:#9aa3b2; --accent:#7c9cff; --accent-strong:#4e75ff;
    --shadow: 0 10px 30px rgba(0,0,0,.35);
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--text); background: var(--bg);
    font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
    letter-spacing:.2px;
  }

  @media (prefers-reduced-motion: reduce) { * { animation: none !important; transition: none !important; } }

  /* background glow */
  body::before{
    content:"";
    position:fixed; inset:0; z-index:-1; pointer-events:none;
    background:
      radial-gradient(120vmax 80vmax at 10% -10%, color-mix(in oklab, var(--accent) 25%, transparent) 0%, transparent 60%),
      radial-gradient(100vmax 70vmax at 90% 0%, color-mix(in oklab, #06b6d4 22%, transparent) 0%, transparent 55%),
      var(--bg);
    background-attachment: fixed,fixed,fixed;
    filter: saturate(110%);
  }

  .wrap{max-width:1200px; margin:0 auto; padding:28px 20px 60px}

  .header{
    position: sticky; top:0; z-index:30;
    backdrop-filter: saturate(120%) blur(10px);
    background: linear-gradient(to bottom, var(--bg-soft), transparent);
  }
  .head-inner{display:flex;align-items:center;justify-content:space-between;gap:14px;padding:14px 20px}
  .brand{display:flex;align-items:center;gap:10px}
  .logo{ width:36px; height:36px; border-radius:12px; background: transparent; box-shadow: var(--shadow); display:grid; place-items:center; overflow: hidden; }
  .logo img{width: 100%; height: 100%; object-fit: contain; display: block;}
  .brand h1{margin:0;font-size:18px;letter-spacing:.4px}
  .actions{display:flex;gap:8px;align-items:center; flex-wrap: wrap;}

  .pill{
    border:1px solid var(--border); background:var(--card); color:var(--text);
    padding:10px 12px; border-radius:999px; display:flex; gap:8px; align-items:center;
    box-shadow: var(--shadow);
  }
  .input{ background:transparent;border:none;outline:none;color:inherit;min-width:220px;font-size:14px; }
  .input:focus-visible, .btn:focus-visible, select:focus-visible, .input-mini:focus-visible { outline: var(--focus); outline-offset: 2px; border-radius: 10px; }
  .btn{
    border:1px solid var(--border); background:var(--card); color:var(--text);
    padding:10px 14px;border-radius:12px;cursor:pointer;transition:transform .12s ease, filter .12s ease;
    box-shadow: var(--shadow);
  }
  .btn:hover{transform:translateY(-1px)}
  .btn:active{transform:translateY(0); filter:saturate(110%)}
  .btn[disabled]{opacity:.6; cursor:not-allowed}
  .btn.primary{background:linear-gradient(135deg,var(--accent),var(--accent-strong)); color:#fff; border-color:transparent}
  .btn.ghost{background:transparent}
  .muted{color:var(--muted)}
  .panel{margin-top:18px;background:color-mix(in oklab, var(--card) 88%, transparent);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow)}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:16px;padding:16px}
  .card{ border:1px solid var(--border); border-radius:16px; overflow:hidden; background:var(--bg-soft); box-shadow: var(--shadow); transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease; display:flex; flex-direction:column; }
  .card:hover{transform:translateY(-2px); border-color: color-mix(in oklab, var(--accent) 50%, var(--border)); box-shadow:0 18px 40px rgba(0,0,0,.18)}
  .cover{position:relative; aspect-ratio:2/3; background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02))}
  .cover img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover; object-position:center; display:block; border-bottom:1px solid var(--border)}
  .shimmer{background:linear-gradient(90deg, rgba(255,255,255,.06), rgba(255,255,255,.15), rgba(255,255,255,.06)); background-size:200% 100%; animation:sh 1.1s infinite}
  @keyframes sh{0%{background-position:200% 0}100%{background-position:-200% 0}}
  .meta{padding:10px 12px 12px; display:flex; flex-direction:column; gap:8px}
  .title{font-weight:700; font-size:14px; line-height:1.25; margin:0}
  .subline{font-size:12px; color:var(--muted)}
  .row{display:flex; gap:8px; flex-wrap:wrap; align-items:center}

  .watch{padding:10px 12px}
  .watch-item{ display:flex; gap:12px; align-items:center; justify-content:space-between; padding:10px 12px; border:1px solid var(--border); border-radius:12px; background:var(--bg-soft) }
  .watch-list{display:grid; gap:10px; padding:0 12px 14px}
  .pager{display:flex; gap:10px; justify-content:center; padding:12px}
  .chip{border:1px solid var(--border); padding:6px 10px; border-radius:999px; font-size:12px; color:var(--muted)}
  .toast{position:fixed; right:18px; bottom:18px; background:#111827; color:#fff; padding:12px 14px; border-radius:12px; box-shadow:0 18px 40px rgba(0,0,0,.35); opacity:0; transform:translateY(8px); pointer-events:none; transition:opacity .15s, transform .15s; font-size:14px; z-index:50}
  .toast.show{opacity:1; transform:translateY(0); pointer-events:auto}
  footer{opacity:.8; font-size:12px; text-align:center; margin-top:22px; color:var(--muted)}
  a{color:var(--accent)}
  @media (max-width:520px){ .hide-sm{display:none} }

  .badge{ display:inline-flex; align-items:center; gap:6px; font-size:12px; padding:4px 8px; border-radius:999px; border:1px solid var(--border); background:var(--bg-soft); color:var(--muted) }
  .badge.ok{ color:#16a34a; border-color:#16a34a33 }
  .badge.warn{ color:#ef4444; border-color:#ef444433 }

  .input-mini{ width:84px; padding:8px 10px; font-size:13px; background:transparent; border:1px solid var(--border); border-radius:10px; color:var(--text) }
  .controls .btn{ padding:8px 10px }
  .controls{ display:flex; gap:8px; align-items:center; flex-wrap:wrap }

  .unread-dot{ width:8px; height:8px; border-radius:999px; background: #ef4444; box-shadow: 0 0 0 0 rgba(239,68,68,.55); animation: pulse 1.8s ease-out infinite; flex: 0 0 auto; margin-top:4px }
  @keyframes pulse{ 0%{box-shadow: 0 0 0 0 rgba(239,68,68,.55)} 70%{box-shadow: 0 0 0 12px rgba(239,68,68,0)} 100%{box-shadow: 0 0 0 0 rgba(239,68,68,0)} }
  .watch-item.unread{ border-color: color-mix(in oklab, #ef4444 45%, var(--border)); box-shadow: 0 8px 24px rgba(239,68,68,.08) }

  .toolbar{ display:flex; gap:10px; align-items:center; justify-content:space-between; padding: 0 12px 10px }
  .left-tools, .right-tools{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
  .checkbox{display:flex; align-items:center; gap:6px; font-size:13px; color:var(--muted)}

  /* modal */
  dialog { border:1px solid var(--border); border-radius:12px; background:var(--card); color:var(--text); padding:0; max-width:720px }
  dialog::backdrop { background: rgba(0,0,0,.4) }
  .modal-head{ display:flex; align-items:center; justify-content:space-between; padding:12px 14px; border-bottom:1px solid var(--border) }
  .modal-body{ padding:12px 14px; display:grid; gap:10px }
  .kvs{ font-size:13px; color:var(--muted) }
  .kvs code{ font-size:12px }
  .tags{ display:flex; flex-wrap:wrap; gap:6px }

  /* ===== Notification history ===== */
  .notif-toolbar { display:flex; align-items:center; justify-content:space-between; gap:10px; padding:8px 12px 12px }
  .notif-count { border:1px solid var(--border); padding:6px 10px; border-radius:999px; font-size:12px; color:var(--muted) }
  .notif-list { display:grid; gap:8px; padding:0 12px 14px }
  .notif-item { display:flex; justify-content:space-between; gap:10px; padding:10px 12px; border:1px solid var(--border); border-radius:12px; background:var(--bg-soft) }
  .notif-left { min-width:0 }
  .notif-title { font-weight:700; overflow:hidden; text-overflow:ellipsis; white-space:nowrap }
  .notif-meta { font-size:12px; color:var(--muted) }
  .notif-actions { display:flex; align-items:center; gap:8px }
  code.mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size:12px }

  /* ====== Layout reordering / Tabs ====== */
  #sections { display:flex; flex-direction:column; gap:16px; }
  #search-group      { order: 10; }
  #watchlist-panel   { order: 20; }
  #notifications     { order: 30; }

  #tabbar { display:none; }
  .tabbar { display:flex; gap:6px; border-bottom:1px solid var(--border); padding:6px; margin-top:8px; }
  .tabbar button[aria-selected="true"] { border-bottom:2px solid var(--accent); }

  body[data-layout="tabs"] #tabbar { display:block; }

  /* ===== Settings Drawer ===== */
  #settings-drawer { position: fixed; top:0; right:0; height:100%; width:min(420px, 92vw); border-left:1px solid var(--border); background:var(--card); box-shadow: -20px 0 60px rgba(0,0,0,.35); transform: translateX(105%); transition: transform .18s ease; z-index:60; display:flex; flex-direction:column }
  #settings-drawer.open { transform: translateX(0); }
  .s-head { display:flex; align-items:center; justify-content:space-between; padding:14px; border-bottom:1px solid var(--border) }
  .s-body { padding:14px; overflow:auto; display:grid; gap:12px }
  .s-section { border:1px solid var(--border); background:var(--bg-soft); border-radius:12px; padding:12px }
  .s-title { margin:0 0 6px 0; font-size:14px }

  /* ==== Solid Settings only ==== */

/* Opaque surface tokens just for Settings */
:root{
  --drawer-dark: rgba(15, 20, 40, 0.98);
  --drawer-pane-dark: rgba(18, 24, 46, 0.98);

  --drawer-light: #fffffff7;      /* ~97% */
  --drawer-pane-light: #ffffff;   /* solid */
}

/* Drawer shell */
[data-theme="dark"] #settings-drawer{
  background: var(--drawer-dark) !important;
  border-left-color: rgba(255,255,255,.16);
}
[data-theme="light"] #settings-drawer{
  background: var(--drawer-light) !important;
  border-left-color: #e3e6ee;
}

/* Drawer header/body sections */
[data-theme="dark"] .s-head,
[data-theme="dark"] .s-section{
  background: var(--drawer-pane-dark) !important;
  border-color: rgba(255,255,255,.16);
}
[data-theme="light"] .s-head,
[data-theme="light"] .s-section{
  background: var(--drawer-pane-light) !important;
  border-color: #e3e6ee;
}

/* Optional: keep drawer content slightly lifted */
#settings-drawer { box-shadow: -20px 0 60px rgba(0,0,0,.40); }

/* Scrim behind the drawer (no HTML changes needed) */
body::after{
  content:"";
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.35);
  opacity: 0;
  pointer-events: none;
  transition: opacity .18s ease;
  z-index: 55; /* drawer is z-index:60 */
}
body.drawer-open::after{ opacity: 1; pointer-events: auto; }